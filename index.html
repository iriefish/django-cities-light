<!DOCTYPE html>
<html>
  <head>
    <meta charset='utf-8'>
    <meta http-equiv="X-UA-Compatible" content="chrome=1">
    <meta name="viewport" content="width=640" />

    <link rel="stylesheet" href="stylesheets/core.css" media="screen"/>
    <link rel="stylesheet" href="stylesheets/mobile.css" media="handheld, only screen and (max-device-width:640px)"/>
    <link rel="stylesheet" href="stylesheets/pygment_trac.css"/>

    <script type="text/javascript" src="javascripts/modernizr.js"></script>
    <script type="text/javascript" src="https://ajax.googleapis.com/ajax/libs/jquery/1.7.1/jquery.min.js"></script>
    <script type="text/javascript" src="javascripts/headsmart.min.js"></script>
    <script type="text/javascript">
      $(document).ready(function () {
        $('#main_content').headsmart()
      })
    </script>
    <title>Django-cities-light by yourlabs</title>
  </head>

  <body>
    <a id="forkme_banner" href="https://github.com/yourlabs/django-cities-light">Fork Me on GitHub</a>
    <div class="shell">

      <header>
        <span class="ribbon-outer">
          <span class="ribbon-inner">
            <h1>Django-cities-light</h1>
            <h2>A Country and an (optionnal) City model and simple features</h2>
          </span>
          <span class="left-tail"></span>
          <span class="right-tail"></span>
        </span>
      </header>

      <section id="downloads">
        <span class="inner">
          <a href="https://github.com/yourlabs/django-cities-light/zipball/master" class="zip"><em>download</em> .ZIP</a><a href="https://github.com/yourlabs/django-cities-light/tarball/master" class="tgz"><em>download</em> .TGZ</a>
        </span>
      </section>

      <span class="banner-fix"></span>

      <section id="main_content">
        <h1>django-cities-light -- <em>Simple django-cities alternative</em>
</h1>

<p>This add-on provides models and commands to import country/city data into your
database.
The data is pulled from <a href="http://www.geonames.org/">GeoNames</a> and contains:</p>

<ul>
<li>country names</li>
<li>optionnal city names</li>
</ul><p>Spatial query support is not required by this application.</p>

<p>This application is very simple and is useful if you want to make a simple
address book for example. If you intend to build a fully featured spatial
database, you should use <a href="https://github.com/coderholic/django-cities">django-cities</a>.</p>

<h2>Installation</h2>

<p>Install django-cities-light:</p>

<pre><code>pip install django-cities-light
</code></pre>

<p>Or the development version:</p>

<pre><code>pip install -e git+git@github.com:yourlabs/django-cities-light.git#egg=cities_light
</code></pre>

<p>Add <code>cities_light</code> to your <code>INSTALLED_APPS</code>.</p>

<p>You may not need the city model and database table. A project like
betspire.com doesn't need it for instance. So the City model will be made
'abstract' if this setting is set as such:</p>

<pre><code>CITIES_LIGHT_ENABLE_CITY=False
</code></pre>

<p>Now, run syncdb, it will only create tables for models that are not disabled:</p>

<pre><code>./manage.py syncdb
</code></pre>

<h2>Data update</h2>

<p>Finally, populate your database with command:</p>

<pre><code>./manage.py cities_light
</code></pre>

<p>This command is well documented, consult the help with:</p>

<pre><code>./manage.py help cities_light
</code></pre>

<h2>Filtering data import</h2>

<p>An example is worth 1000 words: if you want to import only cities from France,
USA and Belgium you could do as such:</p>

<pre><code>import cities_light

def filter_city_import(sender, items, **kwargs):
    if items[8] not in ('FR', 'US', 'BE'):
        raise cities_light.InvalidItems()

cities_light.signals.city_items_pre_import.connect(filter_city_import)
</code></pre>

<p>Note: this signal gets a list rather than a City instance for performance reasons.</p>

<h2>Configure logging</h2>

<p>This command is made to be compatible with background usage like from cron, to
keep the database fresh. So it doesn't do direct output. To get output from
this command, simply configure a handler and formatter for <code>cities_light</code>
logger. For example:</p>

<pre><code>LOGGING = {
    'version': 1,
    'disable_existing_loggers': False,
    'formatters': {
        'simple': {
            'format': '%(levelname)s %(message)s'
        },
    },
    'handlers': {
        'console':{
            'level':'DEBUG',
            'class':'logging.StreamHandler',
            'formatter': 'simple'
        },
    },
    'loggers': {
        'cities_light': {
            'handlers':['console'],
            'propagate': True,
            'level':'DEBUG',
        },
        # also use this one to see SQL queries
        'django': {
            'handlers':['console'],
            'propagate': True,
            'level':'DEBUG',
        },
    }
}
</code></pre>

<h2>Ajax autocomplete</h2>

<p>If <code>ajax_selects</code> from
<a href="https://github.com/crucialfelix/django-ajax-selects">django-ajax-selects</a>, you
should have two new channels usable right away:</p>

<ul>
<li><code>cities_light_country</code></li>
<li><code>cities_light_city</code></li>
</ul><h2>Next features</h2>

<ul>
<li>django-modeltranslation support and alternateNames.txt</li>
<li>country flags support</li>
</ul>
      </section>

      <footer>
        <span class="ribbon-outer">
          <span class="ribbon-inner">
            <p>this project by <a href="https://github.com/yourlabs">yourlabs</a> can be found on <a href="https://github.com/yourlabs/django-cities-light">GitHub</a></p>
          </span>
          <span class="left-tail"></span>
          <span class="right-tail"></span>
        </span>
        <p>Generated with <a href="http://pages.github.com">GitHub Pages</a> using Merlot</p>
        <span class="octocat"></span>
      </footer>

    </div>

    
  </body>
</html>
